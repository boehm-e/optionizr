// Based off https://tonicdev.com/tolmasky/google-image-search
// which was based of https://github.com/Filirom1/node-google-image-search

var request = require('request-sync');
var cheerio = require('cheerio');

function imageSearch(depart, arrivee) {
    var urls = {};


    var URL = 'http://www.bing.com/images/search?&q='+encodeURIComponent(depart)+'&qft=+filterui:imagesize-large&FORM=R5IR3';
    var html = request(URL).body;
    var $ = cheerio.load(html);
    var imgNodes = $('img');
    urls["depart"] = [];
    imgNodes.map(function(imgNodeIdx) {
        var imgNode = imgNodes[imgNodeIdx];
	if (imgNode.parentNode.parent.attribs["href"] != undefined)
	    urls["depart"].push(imgNode.parentNode.parent.attribs["href"]);
    });

    var URL = 'http://www.bing.com/images/search?&q='+encodeURIComponent(arrivee)+'&qft=+filterui:imagesize-large&FORM=R5IR3';
    var html = request(URL).body;
    var $ = cheerio.load(html);
    var imgNodes = $('img');
    urls["destination"] = [];
    imgNodes.map(function(imgNodeIdx) {
        var imgNode = imgNodes[imgNodeIdx];
	if (imgNode.parentNode.parent.attribs["href"] != undefined)
	    urls["destination"].push(imgNode.parentNode.parent.attribs["href"]);
    });

    return urls;
}
module.exports = imageSearch;
